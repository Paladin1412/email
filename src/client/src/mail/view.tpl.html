<!-- target: TPL_mail_view -->
<!-- if: ${email.collapse} -->
<div class="mail-view mail-view-collapse">
<!-- else -->
<div class="mail-view">
<!-- /if -->
    <!-- if: !${email.hide_subject} -->
    <div class="mail-subject">
        <!-- if: ${email.subject} -->
        <h2>${email.subject}</h2>
        <!-- else -->
        <h2>(no subject)</h2>
        <!-- /if -->
        <a href="#/mail/inbox">Inbox</a>
        <!-- if: ${email.labels} -->
            <!-- for: ${email.labels} as ${item} -->
            <a href="#/mail/inbox~label=${item.id}">${item.name}</a>
            <!-- /for -->
        <!-- /if -->
    </div>
    <!-- /if -->

    <div class="list-header">
        <div class="list-summary">
            <table class="list-summary-table">
                <tr>
                  <th>发件人：</th>
                  <td>
                    <a href="mailto:${email.from.address}" title="${email.from.address}"><!-- if: ${email.from.name} -->${email.from.name}<!-- else -->${email.from.address}<!-- /if --></a>
                    &nbsp;|&nbsp;
                    <a data-ui-type="Link" data-ui-id="reply" href="javascript:void(0)">回复</a>
                    &nbsp;|&nbsp;
                    <a data-ui-type="Link" data-ui-id="replyAll" href="javascript:void(0)">全部回复</a>
                    <!-- if: ${email.attachments.length} -->
                    &nbsp;|&nbsp;
                    <a data-ui-disabled="true" data-ui-type="Link" data-ui-id="replyWithAttachments" href="javascript:void(0)">带附件回复</a>
                    <!-- /if -->
                    &nbsp;|&nbsp;
                    <a data-ui-type="Link" data-ui-id="forward" href="javascript:void(0)">转发</a>
                    &nbsp;|&nbsp;
                    <a data-ui-type="Link" data-ui-id="delete" href="javascript:void(0)">删除</a>
                    &nbsp;|&nbsp;
                    <a data-ui-disabled="true" data-ui-type="Link" data-ui-id="addLabel" href="javascript:void(0)">添加标签</a>

                    <time>${email.date}</time>
                  </td>
                </tr>
                <!-- if: ${email.to} -->
                <tr>
                  <th>收件人：</th>
                  <td>
                    <!-- for: ${email.to} as ${item}, ${index} -->
                    <a href="mailto:${item.address}" title="${item.address}"><!-- if: ${item.name} -->${item.name}<!-- else -->${item.address}<!-- /if --></a>;&nbsp;
                    <!-- /for -->
                  </td>
                </tr>
                <!-- /if -->
                <!-- if: ${email.cc} -->
                <tr>
                  <th>抄送：</th>
                  <td>
                    <!-- for: ${email.cc} as ${item}, ${index} -->
                    <a href="mailto:${item.address}" title="${item.address}"><!-- if: ${item.name} -->${item.name}<!-- else -->${item.address}<!-- /if --></a>;&nbsp;
                    <!-- /for -->
                  </td>
                </tr>
                <!-- /if -->
                <!-- if: ${email.bcc} -->
                <tr>
                  <th>密送：</th>
                  <td>
                    <!-- for: ${email.bcc} as ${item}, ${index} -->
                    <a href="mailto:${item.address}" title="${item.address}"><!-- if: ${item.name} -->${item.name}<!-- else -->${item.address}<!-- /if --></a>;&nbsp;
                    <!-- /for -->
                  </td>
                </tr>
                <!-- /if -->
                <tr>
                  <th>源文件：</th>
                  <td>
                    <a href="http://${hostname}:8765/raw/${uidl}.txt" target="_blank">查看</a>
                    &nbsp;|&nbsp;
                    <a href="http://${hostname}:8765/ori/message/${uidl}.html" target="_blank">未过滤内容的邮件</a>
                  </td>
                </tr>
                <!-- if: ${email.attachments.length} -->
                <tr>
                  <th>附件：</th>
                  <td>
                      <!-- for: ${email.attachments} as ${item}, ${index} -->
                      <a href="${item.preview_url}" target="_blank">${item.name} (${item.size})</a>&nbsp;&nbsp;
                      <!-- /for -->
                  </td>
                </tr>
                <!-- /if -->
            </table>
        </div>
    </div>
    <!-- if: ${email.collapse} -->
    <div class="mail-body">加载中...</div>
    <!-- else -->
    <div class="mail-body">
      <!-- if: ${email.is_calendar} -->
          <!-- if: ${email.message.METHOD} == "REQUEST" -->
          <!-- var: vevent = ${email.message.VEVENT} -->
          <table class="mail-calendar">
              <tr>
                  <th>时间：</th>
                  <td>${vevent.DTSTART} - ${vevent.DTEND}</td>
              </tr>
              <tr>
                  <th>地点：</th>
                  <td>${vevent.LOCATION|raw}</td>
              </tr>
              <tr>
                  <th>组织者：</th>
                  <td><a href="mailto:${vevent.ORGANIZER.email}">${vevent.ORGANIZER.name}</a></td>
              </tr>
              <tr>
                  <th>参与人员：</th>
                  <td>
                      <!-- for: ${vevent.ATTENDEE} as ${attendee} -->
                      <a href="mailto:${attendee.email}" title="${attendee.email}">${attendee.name}</a>&nbsp;
                      <!-- /for -->
                  </td>
              </tr>
              <tr>
                  <td colspan="2"><pre>${vevent.DESCRIPTION|raw}</pre></td>
              </tr>
          </table>
          <!-- else -->
          暂不支持显示 ${email.message.METHOD} 类型的日历。
          <!-- /if -->
      <!-- else -->
      ${email.message|raw}
      <!-- /if -->
    </div>
    <!-- /if -->
</div>
